# Maintainer: Nicolas Bourdaud <nicolas.bourdaud@mindmaze.ch>
pkgname=("${MINGW_PACKAGE_PREFIX}-libmmlib0" "${MINGW_PACKAGE_PREFIX}-mmlib-devel")
pkgbase=mmlib
pkgver=1.0.0
pkgrel=1
pkgdesc="MindMaze helper library
  mmlib is the general purpose library providing helper functions to other
  module. It provides facilities for logging, error reporting and basic
  geometry."
arch=('x86_64')
url="https://intranet.mindmaze.ch/mmlabs/gerrit/admin/projects/mmlib"
source=(git+file://${MMSRCS:-${HOME}/sources}/mmlib#branch=master)
sha256sums=(SKIP)

build() {
    cd $pkgbase
    ./autogen.sh
    ./configure --prefix=/usr --enable-sphinxdoc=no \
        --prefix=${MINGW_PREFIX} \
        --build=${MINGW_CHOST} \
        --host=${MINGW_CHOST}

    make
    make DESTDIR=${srcdir}/dest install
}

package_libmmlib0() {
    groups=('base')
    local instdir=${srcdir}/dest/${MINGW_PREFIX}

    mkdir -p ${pkgdir}/${MINGW_PREFIX}
    cp -rf ${instdir}/bin ${pkgdir}/${MINGW_PREFIX}
}

package_mmlib-devel() {
    groups=('base-devel')
    local instdir=${srcdir}/dest/${MINGW_PREFIX}

    mkdir -p ${pkgdir}/${MINGW_PREFIX}
    cp -rf ${instdir}/include ${instdir}/lib ${instdir}/share ${pkgdir}/${MINGW_PREFIX}
}

eval "package_${MINGW_PACKAGE_PREFIX}-libmmlib0() { package_libmmlib0; }"
eval "package_${MINGW_PACKAGE_PREFIX}-mmlib-devel() { package_mmlib-devel; }"
